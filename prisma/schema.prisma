generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  // shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
}

model User {
  id                Int             @id @default(autoincrement())
  email             String          @unique
  phone             String?         @unique
  password          String
  name              String?
  isVerified        Boolean         @default(false)
  // Relations
  wishlist          Wishlist[]
  cart              Cart[]
  productReviews    ProductReview[]
  managedWarehouses Warehouse[]     @relation("UserManagedWarehouses")
  createdWarehouses Warehouse[]     @relation("UserCreatedWarehouses")
  updatedWarehouses Warehouse[]     @relation("UserUpdatedWarehouses")

  bookingProductsAsAgent BookingProduct[] @relation("UserAgentBookingProducts")

  // CustomerBookingProduct
  bookingProductsAsCustomer BookingProduct[] @relation("CustomerBookingProduct")

  roleId                      Int?
  role                        Role?                 @relation(fields: [roleId], references: [id])
  addressId                   Int?
  address                     Address?              @relation(fields: [addressId], references: [id])
  buyNowCarts                 BuyNowCart[]
  otp                         OTP[]
  createdAt                   DateTime              @default(now())
  updatedAt                   DateTime              @updatedAt
  // shopping 
  shoppingBookingsAsCustomer  ShoppingBooking[]     @relation("ShoppingBookingCustomer")
  shoppingBookings     ShoppingBooking[]     @relation("ShoppingBookingUser")

  // shipping 

  // inventory
  inventoryBookings           InventoryBooking[]
  inventoryBookingsAsCustomer InventoryBooking[]    @relation("InventoryBookingCustomer")

  // Shipment
  shipmentBookingsAsCustomer ShipmentBooking[] @relation("ShipmentCustomer")

  cartProductShippings       CartProductShipping[] @relation("CartProductShippingUser")
}

model Role {
  id           Int         @id @default(autoincrement())
  role         String      @unique
  permissionId Int?
  permission   Permission? @relation(fields: [permissionId], references: [id])
  users        User[]
  text         String?
  text2        String?
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt

  // @@map("roles")
}

model Permission {
  id Int @id @default(autoincrement())

  // aboutUs permissions
  aboutUsAccess Boolean @default(false)
  aboutUsCreate Boolean @default(false)
  aboutUsUpdate Boolean @default(false)
  aboutUsDelete Boolean @default(false)

  // banner permissions
  bannerAccess Boolean @default(false)
  bannerCreate Boolean @default(false)
  bannerUpdate Boolean @default(false)
  bannerDelete Boolean @default(false)

  // category permissions
  categoryAccess Boolean @default(false)
  categoryCreate Boolean @default(false)
  categoryUpdate Boolean @default(false)
  categoryDelete Boolean @default(false)

  // subCategory permissions
  subCategoryAccess Boolean @default(false)
  subCategoryCreate Boolean @default(false)
  subCategoryUpdate Boolean @default(false)
  subCategoryDelete Boolean @default(false)

  // chilsCategory permissions (kept existing name)
  chilsCategoryAccess Boolean @default(false)
  chilsCategoryCreate Boolean @default(false)
  chilsCategoryUpdate Boolean @default(false)
  chilsCategoryDelete Boolean @default(false)

  // order permissions
  orderAccess Boolean @default(false)
  orderCreate Boolean @default(false)
  orderUpdate Boolean @default(false)
  orderDelete Boolean @default(false)

  // user permissions
  userAccess Boolean @default(false)
  userCreate Boolean @default(false)
  userUpdate Boolean @default(false)
  userDelete Boolean @default(false)

  roles Role[]
}

model Address {
  id      Int    @id @default(autoincrement())
  street  String
  city    String
  state   String
  country String
  zipCode String
  users   User[]

  @@map("addresses")
}

model Wishlist {
  id           Int      @id @default(autoincrement())
  userRef      User?    @relation(fields: [userRefId], references: [id])
  userRefId    Int?
  productRef   Product? @relation("ProductToWishlist", fields: [productRefId], references: [id])
  productRefId Int?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model WarehouseTransfer {
  id                 String    @id @default(cuid())
  fromWarehouseRef   Warehouse @relation("FromWarehouse", fields: [fromWarehouseRefId], references: [id])
  fromWarehouseRefId String
  toWarehouseRef     Warehouse @relation("ToWarehouse", fields: [toWarehouseRefId], references: [id])
  toWarehouseRefId   String
  inventoryRefId     Int
  quantity           Int
  status             String    @default("Pending")
  createdAt          DateTime  @default(now())
  updatedAt          DateTime  @updatedAt
}

model SubCategory {
  id              Int             @id @default(autoincrement())
  name            String?
  image           String?
  bannerImage     String?
  slug            String?         @unique
  status          Boolean         @default(true)
  categoryRef     Category?       @relation(fields: [categoryRefId], references: [id])
  categoryRefId   Int?
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt
  childCategories ChildCategory[]
  products        Product[]
  coupons         Coupon[]        @relation("SubCategoryToCoupon")
}

model ShippingMethod {
  id             Int      @id @default(autoincrement())
  shippingMethod String?
  rate           Float?
  status         Boolean  @default(true)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
}

model Warehouse {
  id       String          @id @default(cuid())
  name     String          @unique
  code     String          @unique
  address  String
  city     String
  state    String
  zipCode  String
  country  String          @default("USA")
  phone    String
  email    String
  location String?
  status   WarehouseStatus @default(OPERATIONAL)
  type     WarehouseType

  totalCapacity Int
  usedCapacity  Int    @default(0)
  capacityUnit  String @default("sq ft")

  latitude  Float?
  longitude Float?

  weekdaysHours String?
  weekendsHours String?
  holidaysHours String?

  lastInspection  DateTime?
  nextMaintenance DateTime?

  createdBy    Int?
  createdByRef User?    @relation("UserCreatedWarehouses", fields: [createdBy], references: [id])
  updatedBy    Int?
  updatedByRef User?    @relation("UserUpdatedWarehouses", fields: [updatedBy], references: [id])
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  managerRefId Int?
  managerRef   User? @relation("UserManagedWarehouses", fields: [managerRefId], references: [id])

  countryId  Int?
  countryRef Country? @relation(fields: [countryId], references: [id], onDelete: Cascade)

  warehouseSpaces        WarehouseSpace[]
  fromWarehouseTransfers WarehouseTransfer[] @relation("FromWarehouse")
  toWarehouseTransfers   WarehouseTransfer[] @relation("ToWarehouse")
  shipmentBookings       ShipmentBooking[]
  shipmentBookingItems   BookingProduct[]
  shoppingBookings       ShoppingBooking[]
  inventoryBookings      InventoryBooking[]

  @@map("warehouses")
}

model WarehouseSpace {
  id            String   @id @default(cuid())
  name          String
  totalCapacity Int
  description   String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  warehouseId String
  warehouse   Warehouse @relation(fields: [warehouseId], references: [id], onDelete: Cascade)

  spaces      Space[]
  inventories Inventory[]

  @@unique([warehouseId])
  @@index([warehouseId])
  @@map("warehouse_spaces")
}

model Space {
  id          String    @id @default(cuid())
  spaceId     String
  type        SpaceType // AIR, SEA, or EXPRESS
  name        String
  price       String?
  duration    String?
  occupied    Boolean?  @default(false)
  spaceNumber Int?
  capacity    Int
  notes       String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  warehouseSpaceId String
  warehouseSpace   WarehouseSpace @relation(fields: [warehouseSpaceId], references: [id], onDelete: Cascade)

  @@unique([warehouseSpaceId, type, spaceId])
  @@index([warehouseSpaceId])
  @@index([type])
  @@map("spaces")
}

model Inventory {
  id          String        @id @default(cuid())
  code        String
  name        String        @default("Inventory")
  type        InventoryType // TYPE_X, TYPE_Y, or TYPE_Z
  description String?
  price       String?
  duration    String?
  occupied    Boolean?      @default(false)
  spaceNumber Int?
  capacity    Int?
  fixedCbm    Boolean       @default(true)
  notes       String?
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt

  warehouseSpaceId String
  warehouseSpace   WarehouseSpace @relation(fields: [warehouseSpaceId], references: [id], onDelete: Cascade)

  @@unique([warehouseSpaceId, type, code])
  @@index([warehouseSpaceId])
  @@index([type])
  @@map("inventories")
}

enum SpaceType {
  AIR
  SEA
  EXPRESS
}

enum InventoryType {
  TYPE_X
  TYPE_Y
  TYPE_Z
}

enum WarehouseStatus {
  OPERATIONAL
  MAINTENANCE
  CLOSED
  CONSTRUCTION
  ARCHIVE
  OVERLOADED
}

enum WarehouseType {
  DISTRIBUTION_CENTER
  COLD_STORAGE
  FULFILLMENT_CENTER
  BONDED
  MANUFACTURING
  CROSS_DOCK
}

model Package {
  id        String            @id @default(cuid())
  type      PackageStatus
  image     String
  name      String?
  
  size      String?
  weight    String?
  volume    String?
  cbm       String?
  thin      String?        // for Polithin
  category  String?        // for Cartoon
  episodes  String?        // for Cartoon
  
  metadata  Json?
  
  price     String
  status    PackageStatus  @default(ACTIVE)
  createdAt DateTime       @default(now())
  updatedAt DateTime       @updatedAt
  
  @@index([status])
  @@index([type, status])
}

enum PackageStatus {
  ACTIVE
  INACTIVE
  ARCHIVED
}

model SubChildCategory {
  id                 Int            @id @default(autoincrement())
  name               String?
  image              String?
  slug               String?
  status             Boolean        @default(true)
  childCategoryRef   ChildCategory? @relation(fields: [childCategoryRefId], references: [id])
  childCategoryRefId Int?
  createdAt          DateTime       @default(now())
  updatedAt          DateTime       @updatedAt
  products           Product[]      @relation("SubChildCategoryToProduct")
}

model ChildCategory {
  id                 Int                @id @default(autoincrement())
  name               String?
  image              String?
  slug               String?
  status             Boolean            @default(true)
  subCategoryRef     SubCategory?       @relation(fields: [subCategoryRefId], references: [id])
  subCategoryRefId   Int?
  createdAt          DateTime           @default(now())
  updatedAt          DateTime           @updatedAt
  subChildCategories SubChildCategory[]
  products           Product[]          @relation("ChildCategoryToProduct")
}

model ProductReview {
  id           Int      @id @default(autoincrement())
  image        String?
  name         String?
  rating       Int?
  comment      String?
  status       Boolean  @default(true)
  userRef      User?    @relation(fields: [userRefId], references: [id])
  userRefId    Int?
  productRef   Product? @relation(fields: [productRefId], references: [id])
  productRefId Int?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Product {
  id                    Int               @id @default(autoincrement())
  productId             String?
  SKU                   String?           @unique
  name                  String?
  description           String?
  isDiscounted          Boolean           @default(false)
  discountType          String?
  discount              Float?
  costPrice             Float?
  price                 Float?
  mrpPrice              Float?
  discountAmount        Float?
  weight                Float?
  thumbnailImage        String
  backViewImage         String?
  images                String[]
  sizeChartImage        String?
  videoUrl              String?
  status                Boolean?          @default(true)
  slug                  String?           @unique
  freeShipping          Boolean           @default(false)
  brandRef              Brand?            @relation(fields: [brandRefId], references: [id])
  brandRefId            Int?
  mainInventory         Int?
  gender                String?
  inventoryType         String?
  categoryRef           Category?         @relation("CategoryToProduct", fields: [categoryRefId], references: [id])
  categoryRefId         Int?
  subCategoryRef        SubCategory?      @relation(fields: [subCategoryRefId], references: [id])
  subCategoryRefId      Int?
  childCategoryRef      ChildCategory?    @relation("ChildCategoryToProduct", fields: [childCategoryRefId], references: [id])
  childCategoryRefId    Int?
  subChildCategoryRef   SubChildCategory? @relation("SubChildCategoryToProduct", fields: [subChildCategoryRefId], references: [id])
  subChildCategoryRefId Int?
  createdAt             DateTime          @default(now())
  updatedAt             DateTime          @updatedAt
  wishlists             Wishlist[]        @relation("ProductToWishlist")
  // inventories           Inventory[]

  productReviews       ProductReview[]
  // carts                 Cart[]            
  buyNowCarts          BuyNowCart[]     @relation("ProductToCart")
  publishStatus        String?          @default("Publish") // Add publish status with default value
  viewProduct          Int?             @default(0) // Add view count with default value
  // orderProducts         OrderProduct[]
  cartProducts         CartProduct[]
  shipmentBookingItems BookingProduct[]
}

model Policy {
  id        Int      @id @default(autoincrement())
  details   String?
  type      String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model PaymentServiceConfig {
  id            Int      @id @default(autoincrement())
  serviceMethod String?  @default("STEADFAST")
  baseUrl       String?
  userName      String?
  apiKey        String?
  secretKey     String?
  clientKey     String?
  clientId      String?
  clientSecret  String?
  email         String?
  password      String?
  grantType     String?
  status        Boolean  @default(true)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

// model OrderProduct {
//   id             Int       @id @default(autoincrement())
//   order          Order     @relation(fields: [orderId], references: [id])
//   orderId        Int
//   productRef     Product   @relation(fields: [productRefId], references: [id])
//   productRefId   Int
//   inventoryRef   Inventory @relation("InventoryToOrderProduct", fields: [inventoryRefId], references: [id])
//   inventoryRefId Int
//   quantity       Int
//   price          Float?
//   mrpPrice       Float?
//   createdAt      DateTime  @default(now())
//   updatedAt      DateTime  @updatedAt
// }

model OrderBulk {
  id           Int       @id @default(autoincrement())
  name         String
  email        String?
  phone        String
  address      String?
  companyName  String?
  productType  String?
  deliveryDate DateTime?
  quantity     Int?
  description  String?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
}

model Coupon {
  id               Int          @id @default(autoincrement())
  code             String?      @unique
  discount         Float?
  useLimit         Int?         @default(0)
  used             Int?         @default(0)
  startDate        DateTime?
  expireDate       DateTime?
  discountType     String?
  brandRef         Brand?       @relation(fields: [brandRefId], references: [id])
  brandRefId       Int?
  categoryRef      Category?    @relation(fields: [categoryRefId], references: [id])
  categoryRefId    Int?
  subCategoryRef   SubCategory? @relation("SubCategoryToCoupon", fields: [subCategoryRefId], references: [id])
  subCategoryRefId Int?
  createdAt        DateTime     @default(now())
  updatedAt        DateTime     @updatedAt

  campaigns Campaign[] @relation("CouponToCampaign")
}

model Newsletter {
  id        Int      @id @default(autoincrement())
  email     String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// model Inventory {
//   id                Int      @id @default(autoincrement())
//   productRef        Product? @relation(fields: [productRefId], references: [id])
//   productRefId      Int? // Changed from Int? to String?
//   quantity          Int?
//   mrpPrice          Float?
//   price             Float?
//   costPrice         Float?
//   discountType      String?
//   discount          Float?
//   discountAmount    Float?
//   barcode           String?
//   availableQuantity Int?
//   soldQuantity      Int?     @default(0)
//   holdQuantity      Int?     @default(0)
//   inventoryType     String?
//   color             String?
//   name              String?
//   level             String?
//   inventoryID       String?
//   createdAt         DateTime @default(now())
//   updatedAt         DateTime @updatedAt

//   // carts              Cart[]
//   // buyNowCarts BuyNowCart[]
//   // orderProducts      OrderProduct[]      @relation("InventoryToOrderProduct")
// }

model ContactInfo {
  id        Int      @id @default(autoincrement())
  name      String?
  email     String?
  phone     String?
  subject   String?
  message   String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Category {
  id            Int           @id @default(autoincrement())
  name          String?
  image         String?
  vectorImage   String?
  colorCode     String?
  slug          String?       @unique
  status        Boolean       @default(true)
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  subCategories SubCategory[]
  products      Product[]     @relation("CategoryToProduct")
  coupons       Coupon[]      @relation(fields: [], references: [])
}

model BuyNowCart {
  id            Int      @id @default(autoincrement())
  quantity      Int?
  isGuestUser   Boolean  @default(false)
  guestUserRef  String?
  correlationId String?  @unique
  userRef       User?    @relation(fields: [userRefId], references: [id])
  userRefId     Int?
  productRef    Product? @relation("ProductToCart", fields: [productRefId], references: [id])
  productRefId  Int?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model OTP {
  id        Int      @id @default(autoincrement())
  userRef   User?    @relation(fields: [userRefId], references: [id])
  userRefId Int?
  otpHash   String
  expiresAt DateTime
  attempts  Int      @default(0)
  verified  Boolean  @default(false)
  createdAt DateTime @default(now())
}

model Campaign {
  id          Int      @id @default(autoincrement())
  name        String
  couponRef   Coupon?  @relation("CouponToCampaign", fields: [couponRefId], references: [id])
  couponRefId Int?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Brand {
  id        Int      @id @default(autoincrement())
  name      String?
  image     String?
  slug      String?
  status    Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  products Product[]
  coupons  Coupon[]  @relation(fields: [], references: [])
}

model AboutUs {
  id          Int      @id @default(autoincrement())
  header      String?
  title       String?
  description String?
  image       String?
  whatsapp    String?
  email       String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Banner {
  id         Int      @id @default(autoincrement())
  bannerType String?
  image      String?
  link       String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}

model RateShippingMethod {
  id              Int                   @id @default(autoincrement())
  name            String                @unique
  description     String? // optional field, nullable
  createdAt       DateTime              @default(now())
  productShipping CartProductShipping[]
  shippingInfos   ShippingInfo[]
}

model Country {
  id   Int    @id @default(autoincrement())
  name String

  isoCode             String
  zone                String?
  status              Boolean               @default(true)
  createdAt           DateTime              @default(now())
  isShippingCountry   Boolean               @default(false)
  exportCombinations  CountryCombination[]  @relation("ExportCountry")
  importCombinations  CountryCombination[]  @relation("ImportCountry")
  ports               Ports[]
  warehouses          Warehouse[]
  countryHsCodes      CountryHsCode[]
  productShipping     CartProductShipping[] @relation("FromCountry")
  productShippingTo   CartProductShipping[] @relation("ToCountry")
  ShippingFromCountry ShippingInfo[]        @relation("ShippingFromCountry")
  ShippingToCountry   ShippingInfo[]        @relation("ShippingToCountry")

  @@map("countries")
}

model Ports {
  id         Int      @id @default(autoincrement())
  portName   String   @db.VarChar(100)
  portType   PortType @default(Sea)
  created_at DateTime @default(now())

  countryId Int
  country   Country? @relation(fields: [countryId], references: [id])
}

enum PortType {
  Sea
  Air
  Land
}

model RateSippingMethod {
  id          Int      @id @default(autoincrement())
  name        String
  description String?
  createdAt   DateTime @default(now())
  rate        Rate[]
}

model Categorie {
  id             Int             @id @default(autoincrement())
  name           String
  shCategoryCode String
  description    String?
  created_at     DateTime        @default(now())
  subCategories  SubCategories[]
  rateProduct    RateProduct[]
}

model SubCategories {
  id                Int           @id @default(autoincrement())
  categoryId        Int?
  name              String
  shSubCategoryCode String
  description       String?
  created_at        DateTime      @default(now())
  categorie         Categorie?    @relation(fields: [categoryId], references: [id])
  subHeadings       SubHeadings[]
  rateProduct       RateProduct[]
}

model SubHeadings {
  id               Int            @id @default(autoincrement())
  subcategoryId    Int?
  name             String
  hsSubHeadingCode String
  description      String?
  created_at       DateTime       @default(now())
  subCategoriesId  SubCategories? @relation(fields: [subcategoryId], references: [id])
  rateProduct      RateProduct[]
}

model RateProduct {
  id            Int            @id @default(autoincrement())
  categoryId    Int?
  subcategoryId Int?
  subheadingId  Int?
  name          String
  shCode        String
  status        Boolean        @default(true)
  created_at    DateTime       @default(now())
  categorie     Categorie?     @relation(fields: [categoryId], references: [id])
  subCategories SubCategories? @relation(fields: [subcategoryId], references: [id])
  subHeadings   SubHeadings?   @relation(fields: [subheadingId], references: [id])
}

model RateWeightCategorie {
  id         Int      @id @default(autoincrement())
  label      String
  min_weight Decimal
  max_weight Decimal
  created_at DateTime @default(now())
  rate       Rate[]
}

model CountryCombination {
  id              Int      @id @default(autoincrement())
  exportCountryId Int
  importCountryId Int
  status          Boolean  @default(true)
  exportCountry   Country  @relation("ExportCountry", fields: [exportCountryId], references: [id], onDelete: Cascade)
  importCountry   Country  @relation("ImportCountry", fields: [importCountryId], references: [id], onDelete: Cascade)
  created_at      DateTime @default(now())
  rate            Rate[]
}

model Rate {
  id                   Int      @id @default(autoincrement())
  countryCombinationId Int
  category1688Id       Int
  shippingMethodId     Int
  weightCategoryId     Int
  price                Decimal  @db.Decimal(10, 2)
  created_at           DateTime @default(now())

  // Relations
  countryCombination CountryCombination    @relation(fields: [countryCombinationId], references: [id], onDelete: Cascade)
  category1688       Category1688          @relation(fields: [category1688Id], references: [id])
  shippingMethod     RateSippingMethod     @relation(fields: [shippingMethodId], references: [id])
  weightCategory     RateWeightCategorie   @relation(fields: [weightCategoryId], references: [id])
  cartProductVariant CartProductVariant[]
  productShipping    CartProductShipping[]
}

model Category1688 {
  id             Int     @id @default(autoincrement())
  categoryId     Int     @unique
  chineseName    String?
  translatedName String?
  language       String?
  imageUrl       String?
  status         Boolean @default(true)
  leaf           Boolean @default(false)
  level          Int     @default(0)

  isRateCategory Boolean @default(false)

  // parent relation
  parentCateId Int?
  parent       Category1688? @relation("CategoryTree", fields: [parentCateId], references: [categoryId])

  // children relation
  children Category1688[] @relation("CategoryTree")
  rate     Rate[]

  // One-to-One HS Code Config
  hsCodeConfig   HsCodeConfig?
  hsCodeConfigId Int?          @unique // UNIQUE = One-to-One

  // Country specific HS codes (one-to-many)
  countryHsCodes CountryHsCode[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model HsCodeConfig {
  id                    Int           @id @default(autoincrement())
  globalHsCodes         String
  chinaHsCodes          String
  globalMaterialComment String?
  category              Category1688? @relation(fields: [categoryId], references: [id])
  categoryId            Int?          @unique
  createdAt             DateTime      @default(now())
  updatedAt             DateTime      @updatedAt
}

model CountryHsCode {
  id        Int     @id @default(autoincrement())
  countryId Int
  country   Country @relation(fields: [countryId], references: [id], onDelete: Cascade)
  hsCodes   String

  category1688Id Int
  category1688   Category1688 @relation(fields: [category1688Id], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Cart {
  id        Int      @id @default(autoincrement())
  userId    Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  totalPrice  Float? @default(0)
  totalWeight Float? @default(0)
  currency    String @default("Dollar")
  status      String @default("active") // active, pending, checkout

  user            User                  @relation(fields: [userId], references: [id])
  products        CartProduct[]
  productShipping CartProductShipping[]
}

model CartProduct {
  id         Int        @id @default(autoincrement())
  titleTrans String?
  productFor ProductFor @default(FROM1688)

  product1688Id  String?
  productLocalId Int?

  productLocal     Product? @relation(fields: [productLocalId], references: [id])
  productAlibabaId String?

  mainSkuImageUrl String?
  vendorId        Int? // highly recommended

  cartId  Int
  cart    Cart    @relation(fields: [cartId], references: [id], onDelete: Cascade)
  confirm Boolean @default(false) // confirm that the product into cart

  quantity        Int   @default(1)
  totalPrice      Float @default(0)
  calculatedPrice Float @default(0)
  totalWeight     Float @default(0)

  isDeleted Boolean @default(false)

  variants        CartProductVariant[]
  productShipping CartProductShipping[]
  priceRanges     CartProductPriceRange[]
}

model CartProductPriceRange {
  id Int @id @default(autoincrement())

  startQuantity Int
  price         Decimal @db.Decimal(10, 2)
  // amountOnSale quoteType  Number;

  cartProductId Int
  cartProduct   CartProduct @relation(fields: [cartProductId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
}

enum ProductFor {
  FROM1688
  LOCAL
  ALIBABA
}

model CartProductVariant {
  id            Int @id @default(autoincrement())
  cartProductId Int

  skuId  String?
  specId String?

  quantity     Int  @default(1)
  amountOnSale Int?

  // isConfirmedToCart Boolean @default(false) // confirm that this variant is added to cart

  attributeName       String?
  attributeNameSecond String?

  weight      Float?
  dimensions  String?
  price       Float?
  skuImageUrl String?

  shippingRateId Int?
  rate           Int?
  cartProduct    CartProduct @relation(fields: [cartProductId], references: [id], onDelete: Cascade)
  shippingRate   Rate?       @relation(fields: [shippingRateId], references: [id])
}

model CartProductShipping {
  id Int @id @default(autoincrement())

  cartId Int
  cart   Cart @relation(fields: [cartId], references: [id], onDelete: Cascade)
  

  cartProductId Int
  cartProduct   CartProduct @relation(fields: [cartProductId], references: [id], onDelete: Cascade)

  rateId Int?
  rate   Rate? @relation(fields: [rateId], references: [id])

  userId Int?
  user   User? @relation("CartProductShippingUser", fields: [userId], references: [id])


  fromCountryId Int?
  fromCountry   Country? @relation("FromCountry", fields: [fromCountryId], references: [id])

  toCountryId Int?
  toCountry   Country? @relation("ToCountry", fields: [toCountryId], references: [id])

  totalQuantity Int     @default(0)
  approxWeight  Decimal @default("0") @db.Decimal(10, 3)
  weightRange   Decimal @default("0") @db.Decimal(10, 3)

  shippingMethodId Int?
  shippingMethod   RateShippingMethod? @relation(fields: [shippingMethodId], references: [id])
  totalCost        Decimal             @default("0") @db.Decimal(12, 2)

  orderEnabled Boolean @default(false)

  customDuty   Decimal @default("0") @db.Decimal(12, 2)
  vat          Decimal @default("0") @db.Decimal(6, 2)
  handlingFee  Decimal @default("0") @db.Decimal(12, 2)
  packagingFee Decimal @default("0") @db.Decimal(12, 2)

  discount     Decimal @default("0") @db.Decimal(12, 2)
  finalPayable Decimal @default("0") @db.Decimal(12, 2)

  estDeliveryDays    Int?
  actualDeliveryDate DateTime?

  trackingNumber    String?
  trackingURL       String?
  warehouseLocation String?
  shippingStatus    String  @default("pending")

  remarks String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model PolicyType {
  id        Int      @id @default(autoincrement())
  title     String   @unique @db.VarChar(150)
  slug      String   @unique @db.VarChar(100)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  policies Policies[]
}

model Policies {
  id Int @id @default(autoincrement())

  title        String
  description  String?
  policyTypeId Int

  helpfulCount    Int      @default(0)
  notHelpfulCount Int      @default(0)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  policyType PolicyType @relation(fields: [policyTypeId], references: [id])
}

model Guide {
  id          Int          @id @default(autoincrement())
  serial      Int
  title       String
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  guideVideos GuideVideo[] @relation("GuideToVideos")
}

model GuideVideo {
  id          Int     @id @default(autoincrement())
  guideId     Int
  index       Int
  url         String  @db.VarChar(500)
  imgSrc      String?
  videoLength String?
  title       String?
  shortDes    String?
  videoSerial Int

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  guide     Guide    @relation("GuideToVideos", fields: [guideId], references: [id], onDelete: Cascade)
}

model Industry {
  id    Int    @id @default(autoincrement())
  title String
  slug  String @unique

  blogs Blog[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Topic {
  id    Int    @id @default(autoincrement())
  title String
  slug  String @unique

  blogs Blog[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model BlogTag {
  id        Int             @id @default(autoincrement())
  title     String?
  slug      String?
  blogs     BlogTagOnBlog[]
  createdAt DateTime        @default(now())
  updatedAt DateTime        @updatedAt
}

model Blog {
  id              Int             @id @default(autoincrement())
  title           String
  details         String
  slug            String          @unique
  image           String?
  industry        Industry        @relation(fields: [industryId], references: [id])
  industryId      Int
  topic           Topic           @relation(fields: [topicId], references: [id])
  topicId         Int
  status          Boolean         @default(false)
  featured        Boolean         @default(false)
  trendingContent Boolean         @default(false)
  tags            BlogTagOnBlog[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model BlogTagOnBlog {
  id     Int     @id @default(autoincrement())
  blogId Int
  blog   Blog    @relation(fields: [blogId], references: [id], onDelete: Cascade)
  tagId  Int
  tag    BlogTag @relation(fields: [tagId], references: [id], onDelete: Cascade)

  @@unique([blogId, tagId])
}

// order management permissions

// ----------------------------- Shipment Booking -----------------------------
model ShipmentBooking {
  id          Int    @id @default(autoincrement())
  orderNumber String @unique

  shippingbookingItems BookingProduct[]
  warehouseStatus      WarehouseStatus

  shippingInfos ShippingInfo[]

  supplier    Int
  supplierRef Suppliers @relation(fields: [supplier], references: [id])

  customer    Int
  customerRef User @relation("ShipmentCustomer", fields: [customer], references: [id])

  warehouse    String
  warehouseRef Warehouse @relation(fields: [warehouse], references: [id])

  // paymentAgent    Int
  // paymentAgentRef User @relation("ShipmentPaymentAgent", fields: [paymentAgent], references: [id])

  // packingId         Int
  // packing           Packing @relation(fields: [packingId], references: [id])
  // agentStatus       AgentStatus

  paymentAgentNote String?
  paymentStatus    PaymentStatus @default(UNPAID)

  bookingNo   Int
  bookingDate DateTime
  arrivalDate DateTime?

  originCountry      String
  destinationCountry String

  invoice        String?
  packingList    String?
  productPhotos  String?
  trackingNumber Int?

  total_weight_kg    Decimal? @db.Decimal(10, 2)
  total_cbm          Decimal? @db.Decimal(10, 2)
  carton_quantity    Int?
  product_quantity   Int?
  total_product_cost Decimal? @db.Decimal(10, 2)

  status String

  createdAt DateTime @default(now())

  @@map("ShipmentBooking")
}

// ----------------------------- Shopping Booking -----------------------------
model ShoppingBooking {
  id Int @id @default(autoincrement())

  warehouseStatus WarehouseStatus
  bookingProduct  BookingProduct[]

  userId Int
  user   User @relation("ShoppingBookingUser", fields: [userId], references: [id])

  supplier    Int
  supplierRef Suppliers @relation(fields: [supplier], references: [id])

  customer    Int
  customerRef User @relation("ShoppingBookingCustomer", fields: [customer], references: [id])

  warehouse    String
  warehouseRef Warehouse @relation(fields: [warehouse], references: [id])

  // paymentAgent    Int
  // paymentAgentRef User @relation("ShoppingBookingPaymentAgent", fields: [paymentAgent], references: [id])

  // packingId           Int
  // packing             Packing @relation(fields: [packingId], references: [id])

  // shipmentMethod      ShipmentMethod
  // agentStatus         AgentStatus

  paymentAgentNote String?

  bookingNo   Int
  bookingDate DateTime
  arrivalDate DateTime?

  originCountry      String
  destinationCountry String

  invoice        String?
  packingList    String?
  productPhotos  String?
  trackingNumber Int?

  total_weight_kg    Decimal? @db.Decimal(10, 2)
  total_cbm          Decimal? @db.Decimal(10, 2)
  carton_quantity    Int?
  product_quantity   Int?
  total_product_cost Decimal? @db.Decimal(10, 2)

  status String

  createdAt DateTime @default(now())

  @@map("ShoppingBooking")
}

// ----------------------------- Inventory Booking -----------------------------
model InventoryBooking {
  id Int @id @default(autoincrement())

  bookingProduct BookingProduct[]

  supplier    Int
  supplierRef Suppliers @relation(fields: [supplier], references: [id])

  customer    Int
  customerRef User @relation("InventoryBookingCustomer", fields: [customer], references: [id])

  warehouse    String
  warehouseRef Warehouse @relation(fields: [warehouse], references: [id])

  // paymentAgent    Int
  // paymentAgentRef User @relation("InventoryBookingPaymentAgent", fields: [paymentAgent], references: [id])

  // packingId           Int
  // packing             Packing @relation(fields: [packingId], references: [id])

  warehouseStatus WarehouseStatus
  // shipmentMethod      ShipmentMethod
  // agentStatus         AgentStatus

  paymentAgentNote String?

  bookingNo   Int
  bookingDate DateTime
  arrivalDate DateTime?

  originCountry      String
  destinationCountry String

  invoice        String?
  packingList    String?
  productPhotos  String?
  trackingNumber Int?

  total_weight_kg    Decimal? @db.Decimal(10, 2)
  total_cbm          Decimal? @db.Decimal(10, 2)
  carton_quantity    Int?
  product_quantity   Int?
  total_product_cost Decimal? @db.Decimal(10, 2)

  status    String
  createdAt DateTime @default(now())
  user      User?    @relation(fields: [userId], references: [id])
  userId    Int?

  @@map("InventoryBooking")
}

model BookingProduct {
  id Int @id @default(autoincrement())

  titleTrans String?

  bookingProductVariants BookingProductVariant[]

  shipmentBookingId Int?
  shipmentBooking   ShipmentBooking? @relation(fields: [shipmentBookingId], references: [id])

  shoppingBookingId Int?
  shoppingBooking   ShoppingBooking? @relation(fields: [shoppingBookingId], references: [id])

  agentId Int?
  agent   User? @relation("UserAgentBookingProducts", fields: [agentId], references: [id])

  customer    Int
  customerRef User @relation("CustomerBookingProduct", fields: [customer], references: [id])

  warehouseId String?
  warehouse   Warehouse? @relation(fields: [warehouseId], references: [id])

  productId Int?
  product   Product? @relation(fields: [productId], references: [id])

  sku String?

  itemName String

  shippingMark String?

  cartonNumber String? @unique

  quantity Int @default(0)

  grossWeight Decimal @default(0) @db.Decimal(10, 2)

  productType String?

  width  Decimal @default(0) @db.Decimal(10, 2)
  height Decimal @default(0) @db.Decimal(10, 2)
  length Decimal @default(0) @db.Decimal(10, 2)

  cartonSize Decimal @default(0) @db.Decimal(10, 3)

  packagingCharge Decimal @default(0) @db.Decimal(10, 2)

  note String?

  productImage String?

  createdAt          DateTime          @default(now())
  inventoryBooking   InventoryBooking? @relation(fields: [inventoryBookingId], references: [id])
  inventoryBookingId Int?

  suppliers   Suppliers? @relation(fields: [suppliersId], references: [id])
  suppliersId Int?

  @@map("ShipmentBookingItems")
}

model BookingProductVariant {
  id Int @id @default(autoincrement())

  skuId  String?
  specId String?

  quantity     Int  @default(1)
  amountOnSale Int?

  // isConfirmedToCart Boolean @default(false) // confirm that this variant is added to cart

  attributeName       String?
  attributeNameSecond String?

  weight      Float?
  dimensions  String?
  price       Float?
  skuImageUrl String?

  shippingRateId   Int?
  rate             Int?
  bookingProductId Int
  bookingProduct   BookingProduct @relation(fields: [bookingProductId], references: [id], onDelete: Cascade)
  // shippingRate   Rate?       @relation(fields: [shippingRateId], references: [id])
}

model Suppliers {
  id Int @id @default(autoincrement())

  supplierNo      String  @unique
  contact_person  String?
  supplierEmail   String?
  supplierPhone   String?
  supplierAddress String?

  ShipmentBooking ShipmentBooking[]

  createdAt         DateTime           @default(now())
  shoppingBookings  ShoppingBooking[]
  inventoryBookings InventoryBooking[]
  bookingProducts   BookingProduct[]
  // InventoryBooking

  @@map("Suppliers")
}

model ShippingInfo {
  id Int @id @default(autoincrement())

  // orderId Int
  // order   Order @relation(fields: [orderId], references: [id], onDelete: Cascade)

  shippingBookingId Int
  shipmentBooking   ShipmentBooking @relation(fields: [shippingBookingId], references: [id], onDelete: Cascade)

  // shoppingBookingId InventoryBookingId

  shippingMethodId Int?
  shippingMethod   RateShippingMethod? @relation(fields: [shippingMethodId], references: [id])

  fromCountryId Int?
  fromCountry   Country? @relation("ShippingFromCountry", fields: [fromCountryId], references: [id])

  toCountryId Int?
  toCountry   Country? @relation("ShippingToCountry", fields: [toCountryId], references: [id])

  totalQuantity Int
  approxWeight  Decimal @db.Decimal(10, 3)

  totalCost    Decimal @db.Decimal(12, 2)
  customDuty   Decimal @db.Decimal(12, 2)
  vat          Decimal @db.Decimal(6, 2)
  handlingFee  Decimal @db.Decimal(12, 2)
  packagingFee Decimal @db.Decimal(12, 2)
  discount     Decimal @db.Decimal(12, 2)
  finalPayable Decimal @db.Decimal(12, 2)

  estDeliveryDays Int?
  trackingNumber  String?
  trackingURL     String?

  shippingStatus ShippingStatus @default(PENDING)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  countryId Int?
}

enum OrderStatus {
  PENDING
  PAID
  PROCESSING
  SHIPPED
  DELIVERED
  CANCELLED
}

enum PaymentStatus {
  UNPAID
  PAID
  FAILED
  REFUNDED
}

enum ShippingStatus {
  PENDING
  CONFIRMED
  IN_TRANSIT
  DELIVERED
  RETURNED
}

// model Payment {
//   id Int @id @default(autoincrement())

//   orderId Int
//   order   Order @relation(fields: [orderId], references: [id], onDelete: Cascade)

//   userId Int?
//   user   User? @relation(fields: [userId], references: [id])

//   amount Decimal @db.Decimal(12,2)
//   currency String @default("Dollar")

//   method PaymentMethod
//   status PaymentStatus @default(PENDING)

//   transactionId String? @unique
//   gateway String? // SSLCommerz, Stripe, Paypal

//   gatewayPayload Json? // full gateway response snapshot

//   paidAt DateTime?
//   failureReason String?

//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt
// }
// enum PaymentMethod {
//   CARD
//   BKASH
//   NAGAD
//   ROCKET
//   PAYPAL
//   STRIPE
//   BANK
//   CASH
// }
// enum PaymentStatus {
//   PENDING
//   SUCCESS
//   FAILED
//   CANCELLED
//   REFUNDED
//   PARTIAL
// }
