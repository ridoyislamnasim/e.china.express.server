model Wishlist {
  id           Int      @id @default(autoincrement())
  userRef      User?    @relation(fields: [userRefId], references: [id])
  userRefId    Int?
  productRef   Product? @relation("ProductToWishlist", fields: [productRefId], references: [id])
  productRefId Int?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model BuyNowCart {
  id            Int      @id @default(autoincrement())
  quantity      Int?
  isGuestUser   Boolean  @default(false)
  guestUserRef  String?
  correlationId String?  @unique
  userRef       User?    @relation(fields: [userRefId], references: [id])
  userRefId     Int?
  productRef    Product? @relation("ProductToCart", fields: [productRefId], references: [id])
  productRefId  Int?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model Cart {
  id        Int      @id @default(autoincrement())
  userId    Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  totalPrice  Float? @default(0)
  totalWeight Float? @default(0)
  currency    String @default("Dollar")
  status      String @default("active")

  user            User                  @relation(fields: [userId], references: [id])
  products        CartProduct[]
  productShipping CartProductShipping[]
}

model CartProduct {
  id         Int        @id @default(autoincrement())
  titleTrans String?
  productFor ProductFor @default(FROM1688)

  product1688Id  String?
  productLocalId Int?

  productLocal     Product? @relation(fields: [productLocalId], references: [id])
  productAlibabaId String?

  mainSkuImageUrl String?
  vendorId        Int?

  cartId  Int
  cart    Cart    @relation(fields: [cartId], references: [id], onDelete: Cascade)
  confirm Boolean @default(false)

  quantity        Int   @default(1)
  totalPrice      Float @default(0)
  calculatedPrice Float @default(0)
  totalWeight     Float @default(0)

  isDeleted Boolean @default(false)

  variants        CartProductVariant[]
  productShipping CartProductShipping[]
  priceRanges     CartProductPriceRange[]
}

model CartProductPriceRange {
  id Int @id @default(autoincrement())

  startQuantity Int
  price         Decimal @db.Decimal(10, 2)

  cartProductId Int
  cartProduct   CartProduct @relation(fields: [cartProductId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
}

model CartProductVariant {
  id            Int @id @default(autoincrement())
  cartProductId Int

  skuId  String?
  specId String?

  quantity     Int  @default(1)
  amountOnSale Int?

  attributeName       String?
  attributeNameSecond String?

  weight      Float?
  dimensions  String?
  price       Float?
  skuImageUrl String?

  shippingRateId Int?
  rate           Int?
  cartProduct    CartProduct @relation(fields: [cartProductId], references: [id], onDelete: Cascade)
  shippingRate   Rate?       @relation(fields: [shippingRateId], references: [id])
}

model CartProductShipping {
  id Int @id @default(autoincrement())

  cartId Int
  cart   Cart @relation(fields: [cartId], references: [id], onDelete: Cascade)

  cartProductId Int
  cartProduct   CartProduct @relation(fields: [cartProductId], references: [id], onDelete: Cascade)

  rateId Int?
  rate   Rate? @relation(fields: [rateId], references: [id])

  userId Int?
  user   User? @relation("CartProductShippingUser", fields: [userId], references: [id])

  fromCountryId Int?
  fromCountry   Country? @relation("FromCountry", fields: [fromCountryId], references: [id])

  toCountryId Int?
  toCountry   Country? @relation("ToCountry", fields: [toCountryId], references: [id])

  totalQuantity Int     @default(0)
  approxWeight  Decimal @default("0") @db.Decimal(10, 3)
  weightRange   Decimal @default("0") @db.Decimal(10, 3)

  shippingMethodId Int?
  shippingMethod   RateShippingMethod? @relation(fields: [shippingMethodId], references: [id])
  totalCost        Decimal             @default("0") @db.Decimal(12, 2)

  orderEnabled Boolean @default(false)

  customDuty   Decimal @default("0") @db.Decimal(12, 2)
  vat          Decimal @default("0") @db.Decimal(6, 2)
  handlingFee  Decimal @default("0") @db.Decimal(12, 2)
  packagingFee Decimal @default("0") @db.Decimal(12, 2)

  discount     Decimal @default("0") @db.Decimal(12, 2)
  finalPayable Decimal @default("0") @db.Decimal(12, 2)

  estDeliveryDays    Int?
  actualDeliveryDate DateTime?

  trackingNumber    String?
  trackingURL       String?
  warehouseLocation String?
  shippingStatus    String  @default("pending")

  remarks String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
