model ShipmentBooking {
  // indentifier
  id             Int     @id @default(autoincrement())

  invoice          String?
  packingList      String?
  totalWeightkg    Decimal? @db.Decimal(10, 2)
  totalCBM        Decimal? @db.Decimal(10, 2)
  totalProductCost Decimal? @db.Decimal(10, 2)

  cartonQuantity  Int?
  productQuantity Int?
  weight          Decimal? @db.Decimal(10, 2)

  // Identifiers for relations
  orderNumber    String  @unique
  trackingNumber String?
  shippingMark    String?
  bookingNo        Int?

  // category
  categoryId  Int?    
  categoryRef Category1688? @relation(fields: [categoryId], references: [id])

  // files
  productPhotos     String?
  invoicePhotos     String?
  packingListPhotos String?

  // method relation
  shippingMethodId  Int?
  shippingMethodRef RateShippingMethod? @relation(fields: [shippingMethodId], references: [id])

  // note
  warehouseReceivingNote String?
  paymentAgentNote       String?

  // Date
  bookingDate  DateTime?
  arrivalDate  DateTime?
  shippingDate DateTime?

  // status
  mainStatus               MainStatus?
  paymentStatus            PaymentStatus            @default(UNPAID)
  warehouseReceivingStatus WarehouseReceivingStatus

  //shipping price 
  shippingPrice        Decimal?      @db.Decimal(10, 2)
  shippingDiscount     Decimal?      @db.Decimal(10, 2)
  shippingDiscountType DiscountType?
  shippingDiscountAmount     Decimal?  @default(0)    @db.Decimal(10, 2)

  // packing price
  packagingCharge     Decimal?      @db.Decimal(10, 2)
  packageDiscount     Decimal?      @db.Decimal(10, 2)
  packageDiscountType DiscountType?
  packagingDiscountAmount Decimal? @default(0) @db.Decimal(10, 2)

  // branding price
  brandingCharge     Decimal?      @db.Decimal(10, 2)
  brandingDiscount     Decimal?      @db.Decimal(10, 2)
  brandingDiscountType DiscountType?
  brandingDiscountAmount Decimal? @default(0) @db.Decimal(10, 2)

  // packaging relation
  packageQuantity     Int?          @default(1)
  packageId           String?
  packageRef          Package?      @relation(fields: [packageId], references: [id])

  // suppliers relation
  supplierId  Int?
  supplierRef Suppliers? @relation(fields: [supplierId], references: [id])

  // Customer relation
  customerId  Int?
  customerRef User? @relation("ShipmentCustomer", fields: [customerId], references: [id])

  // country & warehouse  relation
  exportCountryId    Int?
  importCountryId    Int?
  exportCountryRef   Country?    @relation("ShipmentExportCountry", fields: [exportCountryId], references: [id])
  importCountryRef   Country?   @relation("ShipmentImportCountry", fields: [importCountryId], references: [id])
  exportWarehouseId  String?
  importWarehouseId  String?
  exportWarehouseRef Warehouse?  @relation("ShipmentExportWarehouse", fields: [exportWarehouseId], references: [id])
  importWarehouseRef Warehouse? @relation("ShipmentImportWarehouse", fields: [importWarehouseId], references: [id])

  // space relation
  spaceId    String?
  spaceRef   Space?  @relation(fields: [spaceId], references: [id])
  spaceCapacity Int?     // confirm হওয়া booking এর space use

  // rate relation
  rateId         Int?
  rateRef        Rate?        @relation(fields: [rateId], references: [id])
  expressRateId  Int?
  expressRateRef ExpressRate? @relation("ExpressRate", fields: [expressRateId], references: [id])
  freightRateId  Int?
  freightRateRef FreightRate? @relation("FreightRate", fields: [freightRateId], references: [id])

  
  shipmentBookingItems   BookingProduct[]
  shippingInfos          ShippingInfo[]
  bookingProductVariants BookingProductVariant[]
  shipmentCartons        ShipmentCarton[]
  localDeliveryInfo      LocalDeliveryInfo?

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  @@map("ShipmentBooking")
}

model ShoppingBooking {
  id                       Int                      @id @default(autoincrement())

    // Identifiers for relations
  orderNumber    String  @unique
  trackingNumber String?
  shippingMark    String?
  bookingNo        Int?

  // Customer relation
  customerId  Int?
  customerRef User? @relation("ShoppingBookingCustomer", fields: [customerId], references: [id])

  // country & warehouse  relation
  exportCountryId    Int?
  importCountryId    Int?
  exportCountryRef   Country?    @relation("ShoppingBookingExportCountry", fields: [exportCountryId], references: [id])
  importCountryRef   Country?   @relation("ShoppingBookingImportCountry", fields: [importCountryId], references: [id])
  exportWarehouseId  String?
  importWarehouseId  String?
  exportWarehouseRef Warehouse?  @relation("ShoppingBookingExportWarehouse", fields: [exportWarehouseId], references: [id])
  importWarehouseRef Warehouse? @relation("ShoppingBookingImportWarehouse", fields: [importWarehouseId], references: [id])

  // address relation
  addressId Int?
  addressRef   Address? @relation(fields: [addressId], references: [id])

    // note
  warehouseReceivingNote String?
  paymentAgentNote       String?

    // Date
  bookingDate  DateTime?
  arrivalDate  DateTime?
  shippingDate DateTime?

  
  // status
  mainStatus               MainStatus?
  paymentStatus            PaymentStatus            @default(UNPAID)
  warehouseReceivingStatus WarehouseReceivingStatus

  // product price 
  totalProductCost Decimal? @db.Decimal(10, 2)
  productCostDiscount     Decimal?      @db.Decimal(10, 2)
  productCostDiscountType DiscountType?
  productCostDiscountAmount Decimal? @default(0) @db.Decimal(10, 2)

  // coupon discount
      

  //shipping price 
  shippingPrice        Decimal?      @db.Decimal(10, 2)
  shippingDiscount     Decimal?      @db.Decimal(10, 2)
  shippingDiscountType DiscountType?
  shippingDiscountAmount     Decimal?  @default(0)    @db.Decimal(10, 2)

  // packing price
  packagingCharge     Decimal?      @db.Decimal(10, 2)
  packageDiscount     Decimal?      @db.Decimal(10, 2)
  packageDiscountType DiscountType?
  packagingDiscountAmount Decimal? @default(0) @db.Decimal(10, 2)

  // branding price
  brandingCharge     Decimal?      @db.Decimal(10, 2)
  brandingDiscount     Decimal?      @db.Decimal(10, 2)
  brandingDiscountType DiscountType?
  brandingDiscountAmount Decimal? @default(0) @db.Decimal(10, 2)

  // packaging relation
  packageQuantity     Int?          @default(1)
  packageId           String?
  packageRef          Package?      @relation(fields: [packageId], references: [id])

// product relation
  bookingProduct           BookingProduct[]






  invoice                  String?
  packingList              String?
  productPhotos            String?
  total_weight_kg          Decimal?                 @db.Decimal(10, 2)
  total_cbm                Decimal?                 @db.Decimal(10, 2)
  total_product_cost       Decimal?                 @db.Decimal(10, 2)
  status                   String
  createdAt                DateTime                 @default(now())
  cartonQuantity           Int?
  productQuantity          Int?
  // rate relation
  rateId                   Int?
  rate                     Rate?                    @relation(fields: [rateId], references: [id])

  shoppingBookingCustomer  User                     @relation("ShoppingBookingCustomer", fields: [customerId], references: [id])
  
  @@map("ShoppingBooking")
}

model InventoryBooking {
  id                       Int                      @id @default(autoincrement())
  supplier                 Int
  customer                 Int
  warehouse                String
  paymentAgentNote         String?
  bookingNo                Int
  bookingDate              DateTime
  arrivalDate              DateTime?
  invoice                  String?
  packingList              String?
  productPhotos            String?
  trackingNumber           Int?
  total_weight_kg          Decimal?                 @db.Decimal(10, 2)
  total_cbm                Decimal?                 @db.Decimal(10, 2)
  total_product_cost       Decimal?                 @db.Decimal(10, 2)
  status                   String
  createdAt                DateTime                 @default(now())
  userId                   Int?
  cartonQuantity           Int?
  productQuantity          Int?
  shippingDate             DateTime?
  warehouseReceivingStatus WarehouseReceivingStatus

  customerRef              User                     @relation("InventoryBookingCustomer", fields: [customer], references: [id])
  supplierRef              Suppliers                @relation(fields: [supplier], references: [id])
  user                     User?                    @relation(fields: [userId], references: [id])
  warehouseRef             Warehouse                @relation(fields: [warehouse], references: [id])
  bookingProduct           BookingProduct[]

  @@map("InventoryBooking")
}

model BookingProduct {
  id                     Int                     @id @default(autoincrement())
  titleTrans             String?
  shipmentBookingId      Int?
  shoppingBookingId      Int?
  agentId                Int?
  customer               Int
  warehouseId            String?
  productId              Int?
  sku                    String?
  itemName               String
  shippingMark           String?
  cartonNumber           String?                 @unique
  quantity               Int                     @default(0)
  grossWeight            Decimal                 @default(0) @db.Decimal(10, 2)
  productType            String?
  width                  Decimal                 @default(0) @db.Decimal(10, 2)
  height                 Decimal                 @default(0) @db.Decimal(10, 2)
  length                 Decimal                 @default(0) @db.Decimal(10, 2)
  cartonSize             Decimal                 @default(0) @db.Decimal(10, 3)
  packagingCharge        Decimal                 @default(0) @db.Decimal(10, 2)
  note                   String?
  productImage           String?
  createdAt              DateTime                @default(now())
  inventoryBookingId     Int?
  suppliersId            Int?
  // shipping Booking relations
  bookingProductVariants BookingProductVariant[]
  agent                  User?                   @relation("UserAgentBookingProducts", fields: [agentId], references: [id])
  customerRef            User                    @relation("CustomerBookingProduct", fields: [customer], references: [id])
  inventoryBooking       InventoryBooking?       @relation(fields: [inventoryBookingId], references: [id])
  product                Product?                @relation(fields: [productId], references: [id])
  shipmentBooking        ShipmentBooking?        @relation(fields: [shipmentBookingId], references: [id])
  shoppingBooking        ShoppingBooking?        @relation(fields: [shoppingBookingId], references: [id])
  suppliers              Suppliers?              @relation(fields: [suppliersId], references: [id])
  warehouse              Warehouse?              @relation(fields: [warehouseId], references: [id])

  @@map("ShipmentBookingItems")
}

model BookingProductVariant {
  id                  Int              @id @default(autoincrement())
  skuId               String?
  specId              String?
  colorHex            String?
  colorName           String?
  sizeName            String?
  quantity            Int              @default(1)
  amountOnSale        Int?
  attributeName       String?
  attributeNameSecond String?
  weight              Float?
  dimensions          String?
  price               Float?
  skuImageUrl         String?
  shippingRateId      Int?
  rate                Int?
  // ShipmentBooking relation
  shipmentBookingId   Int?
  shippingRate        ShipmentBooking? @relation(fields: [shipmentBookingId], references: [id])

  bookingProductId Int?
  bookingProduct   BookingProduct? @relation(fields: [bookingProductId], references: [id], onDelete: Cascade)
}

model Suppliers {
  id                Int                @id @default(autoincrement())
  supplierNo        String             @unique
  contact_person    String?
  supplierEmail     String?
  supplierPhone     String?
  supplierAddress   String?
  createdAt         DateTime           @default(now())
  inventoryBookings InventoryBooking[]
  ShipmentBooking   ShipmentBooking[]
  bookingProducts   BookingProduct[]
  shoppingBookings  ShoppingBooking[]

  @@map("Suppliers")
}

model ShippingInfo {
  id                Int                 @id @default(autoincrement())
  shippingBookingId Int
  shippingMethodId  Int?
  fromCountryId     Int?
  toCountryId       Int?
  totalQuantity     Int
  approxWeight      Decimal             @db.Decimal(10, 3)
  totalCost         Decimal             @db.Decimal(12, 2)
  customDuty        Decimal             @db.Decimal(12, 2)
  vat               Decimal             @db.Decimal(6, 2)
  handlingFee       Decimal             @db.Decimal(12, 2)
  packagingFee      Decimal             @db.Decimal(12, 2)
  discount          Decimal             @db.Decimal(12, 2)
  finalPayable      Decimal             @db.Decimal(12, 2)
  estDeliveryDays   Int?
  trackingNumber    String?
  trackingURL       String?
  shippingStatus    ShippingStatus      @default(PENDING)
  createdAt         DateTime            @default(now())
  updatedAt         DateTime            @updatedAt
  countryId         Int?
  fromCountry       Country?            @relation("ShippingFromCountry", fields: [fromCountryId], references: [id])
  shipmentBooking   ShipmentBooking     @relation(fields: [shippingBookingId], references: [id], onDelete: Cascade)
  shippingMethod    RateShippingMethod? @relation(fields: [shippingMethodId], references: [id])
  toCountry         Country?            @relation("ShippingToCountry", fields: [toCountryId], references: [id])
}

model LocalDeliveryInfo {
  id Int @id @default(autoincrement())

  deliveryDate DateTime
  timeSlot     String // e.g. "Evening (3PM - 6PM)"

  contactPerson       String
  phoneNumber         String
  deliveryAddress     String
  specialInstructions String?

  shipmentBookingId Int             @unique
  shipmentBooking   ShipmentBooking @relation(fields: [shipmentBookingId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model ShipmentCarton {
  id Int @id @default(autoincrement())

  shipmentBookingId Int
  shipmentBooking   ShipmentBooking @relation(fields: [shipmentBookingId], references: [id], onDelete: Cascade)

  cartonNumber Int // 1,2,3,4...

  widthCm  Decimal @db.Decimal(10, 2)
  heightCm Decimal @db.Decimal(10, 2)
  lengthCm Decimal @db.Decimal(10, 2)

  cbm Decimal? @db.Decimal(10, 4)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([shipmentBookingId, cartonNumber])
}
